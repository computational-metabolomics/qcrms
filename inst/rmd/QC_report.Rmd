---
title: "LC-MS pre-processing report"
author: "`r print(QCreportObject$projectInfo$author)`"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  pdf_document: default
---

```{r setup, include=FALSE}
require (knitr, quietly=T)
#knitr::opts_chunk$set(echo = TRUE)
#opts_knit$set(root.dir = projectdir)
```

&nbsp;

&nbsp;

&nbsp;


## Data processing summary
```{r projectsetup, echo=F, message=FALSE, warning=FALSE, cache=FALSE, comment="", strip.white=TRUE}
print(kable(QCreportObject$projectHeader))
```

&nbsp;

&nbsp;

&nbsp;


**XCMS peak picking summary:**
```{r xset_sum, echo=FALSE, message=FALSE, warning=FALSE, comment=""}
print(kable(QCreportObject$peakPickingParams))
```
\newpage
```{r s1, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, fig.width=7}
QCreportObject$plots$ticplot_1
```

`r figs("S1")`

\newpage
```{r s2, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, fig.width=7}
print(QCreportObject$plots$ticplot_2)
```

`r figs("S2")`

\newpage
```{r s3, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, fig.width=7}
print(QCreportObject$plots$ticplot_3)
```

`r figs("S3")`

\newpage
```{r s4, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, fig.width=7}
print(QCreportObject$plots$ticplot_4)
```

`r figs("S4")`
&nbsp;

&nbsp;

`r tbls("S1")`

```{r t1, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, fig.width=7}
kable (QCreportObject$tables$corrMatrix, digits=10)
```

\newpage
```{r S5, echo=FALSE, message=FALSE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6, prompt=FALSE}
print (QCreportObject$plots$PCAallSamples)
```

`r figs("S5")`

```{r S6, echo=FALSE, message=FALSE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6, prompt=FALSE}
if (!is.null(QCreportObject$QC_label))
{
  print(QCreportObject$plots$PCAQCsamples)
}
```

`r figs("S6")`

\newpage
```{r S7, echo=FALSE, message=FALSE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6, prompt=FALSE}
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$PCAQCleading)
}
```

`r figs("S7")`

\newpage
```{r S8, echo=FALSE, message=FALSE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6, prompt=FALSE}
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$PCAallQCleading)
}
```

`r figs("S8")`

\newpage
```{r EICs, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, fig.width=7, fig.height=6}
#print(QCreportObject$plots$EICs)
QCreportObject$plots$EICs[[2]] <- QCreportObject$plots$EICs[[2]] + theme(legend.position = "none")
QCreportObject$plots$EICs[[3]] <- QCreportObject$plots$EICs[[3]] + theme(legend.position = "none")
grid.arrange (grobs=QCreportObject$plots$EICs, layout_matrix=matrix(c(1,2,1,3), nrow=2, ncol=2))
```

`r figs("S9")`

\newpage
```{r missing_values, echo=FALSE, fig.height=6, fig.width=7, message=FALSE, warning=FALSE, cache=FALSE, comment="", results='hide'}
multiplot (QCreportObject$plots$MVplot1, QCreportObject$plots$MVplot2, 
           QCreportObject$plots$MVplot3, QCreportObject$plots$MVplot4, layout=matrix (1:4, ncol=2, byrow = T))
```

`r figs("S10")`

\newpage
```{r S11, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6}
print(QCreportObject$plots$RSDplot1)
```

`r figs("S11")`
&nbsp;

&nbsp;

`r tbls("S2")`

```{r T2, echo=F, message=FALSE, warning=FALSE, cache=FALSE, comment="", strip.white=TRUE}
kable (QCreportObject$tables$RSDtable1, digits=1)
```

\newpage
```{r rsd_values_3, echo=FALSE, message=TRUE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6}
print (QCreportObject$plots$RSDplot2)
```

`r figs("S12")`

\newpage
```{r S13, echo=FALSE, message=FALSE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6}
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$QCplot1)
}
```

`r figs("S13")`

\newpage
```{r S14, echo=FALSE, message=FALSE, warning=FALSE, comment="", cache=FALSE, results='hide', fig.width=7, fig.height=6}
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$QCplot2)
}
```

`r figs("S14")`

\newpage
```{r SB_correction_2, echo=FALSE, fig.height=6, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment="", results='hide'}
if (!is.null(QCreportObject$QC_label)) print(QCreportObject$plots$SBPCAbefore)
```

`r figs("S15")`

\newpage
```{r SB_correction_2a, echo=FALSE, fig.height=6, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment="", results='hide'}
if (!is.null(QCreportObject$QC_label)) print(QCreportObject$plots$SBPCAbeforeQC)
```

`r figs("S16")`

\newpage
```{r SB_correction_3, echo=FALSE, fig.height=7, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment="", results='hide'}
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$SBPCAafter)
}
```

`r figs("S17")`

\newpage
```{r SB_correction_3a, echo=FALSE, fig.height=7, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment="", results='hide'}
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$SBPCAafterQC)
}
```

`r figs("S18")`

\newpage
```{r S19, echo=FALSE, fig.height=7, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment="", results='hide'}
#Figure S17
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$SBRSDbefore)
}
```

`r figs("S19")`

\newpage
```{r S20, echo=FALSE, fig.height=7, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment="", results='hide'}
if (!is.null(QCreportObject$QC_label))
{
  print (QCreportObject$plots$SBRSDafter)
}
```

`r figs("S20")`

\newpage
`r tbls("S3")`

```{r T3, echo=FALSE, fig.height=6, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment=""}
if (!is.null(QCreportObject$QC_label))
{
  kable (QCreportObject$tables$SBtableBefore, digits=1)
}
```
&nbsp;

&nbsp;

`r tbls("S4")`

```{r T4, echo=FALSE, fig.height=6, fig.width=7, message=TRUE, warning=FALSE, cache=FALSE, comment=""}
if (!is.null(QCreportObject$QC_label))
{
  kable (QCreportObject$tables$SBtableAfter, digits=1)
}
```

\newpage
`r tbls("S5")`
&nbsp;

```{r sampinfo_2, echo=F, message=FALSE, warning=FALSE, cache=FALSE, comment="", strip.white=TRUE}
kable (QCreportObject$samp.sum, catption="Summary of the sample metadata of the analytical batch")
```


